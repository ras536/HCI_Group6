<!DOCTYPE html>

<html lang="en">

<head>
  <!-- Bootstrap Core CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
	
	<!-- Custom CSS -->
	<link href="css/custom.css" rel="stylesheet">
	<link href="css/navbar.css" rel="stylesheet">
	<link href="css/home.css" rel="stylesheet">
	<link href="css/user_dropdown.css" rel="stylesheet">
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	<link href="css/settings.css" rel="stylesheet">
	
	<!-- Imported Fonts -->
	<link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	
	<title>FedEx Ramp Dashboard</title>
</head>

<body>
  <!-- Header -->
	<div class="bg-fedex-purple">
		<section id="header">
			<div class="container">
				<div class="row">
					<div class="col-lg-12 text-center ">
						<div class="col-xs-3">
							<div class="row">
								<h4>
									<p class="header-info" id="userName">User: JDOE</p>
								</h4>
							</div>
							<div class="row">
								<h4 id="curDate"></h4>
								
							</div>
						</div>
						<div class="col-xs-6">
							<h1>FedEx Ramp Dashboard</h1>
						</div>
						<div class="col-xs-3">
							<h2>
								<a href = "alerts.html" onclick="location.href=this.href+'?'+queryStringParams;return false;">
									<div class="alert-button">
										<i class="fa fa-exclamation-triangle"></i>
										<span class="button__badge" id="button_badge" value="6">6</span>
									</div>
								</a>
								<div id='cssmenu'>
									<ul>
										<li class="has-sub fa fa-user header-icon" aria-hidden="true">
											<ul>
												<li class='has-sub'><a data-toggle="modal" data-target="#settings_modal" href="#"><span>Settings</span></a></li>
												<li class='has-sub'><a href='login.html'><span>Logout</span></a></li>	
											</ul>
										</li>
									</ul>
								</div>
								<a href = "#">
									<p class="fa fa-download header-icon" aria-hidden="true"></p>
								</a>
							</h2>
						</div>
					</div>
				</div>
			</div>
		</section>
	</div>

  <div class="container">
    <div id="wrapper" class="toggled">
      <!-- sidebar -->
      <div id="sidebar-wrapper">
      <ul class="sidebar-nav" style="margin-left: 0">
        <li class="sidebar-brand">
          <a href="#menu-toggle" id="menu-toggle" style="margin-top:20px;float:right;" >
          <i class="fa fa-bars " style="font-size:20px !Important;" aria-hidden="true" aria-hidden="true"></i></a>
        </li>
        <li class="currentPage">
          <a href="index.html" onclick="location.href=this.href+'?'+queryStringParams;return false;">
		  <font color="white">
          <i class="fa fa-home " aria-hidden="true"></i>
          <span style="margin-left:10px;">Home</span></font></a>
        </li>
        <li>
          <a href="packages.html" onclick="location.href=this.href+'?'+queryStringParams;return false;">
          <i class="fa fa-cubes " aria-hidden="true"></i>
          <span style="margin-left:10px;">Packages</span></a>
        </li>
        <li>
          <a href="planning.html" onclick="location.href=this.href+'?'+queryStringParams;return false;">
          <i class="fa fa-sliders" aria-hidden="true"></i>
          <span style="margin-left:10px;">Sort Planning</span></a>
        </li>
        <li>
          <a href="visuals.html" onclick="location.href=this.href+'?'+queryStringParams;return false;">
          <i class="fa fa-area-chart " aria-hidden="true"></i>
          <span style="margin-left:10px;">Visuals </span> </a>
        </li>
        <li>
          <a href="alerts.html" onclick="location.href=this.href+'?'+queryStringParams;return false;">
          <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
          <span style="margin-left:10px;"> Alerts</span></a>
        </li>
        <li>
          <a href="history.html" onclick="location.href=this.href+'?'+queryStringParams;return false;">
          <i class="fa fa-book" aria-hidden="true"></i>
          <span style="margin-left:10px;">History</span></a>
        </li>
      </ul>
      </div><!-- /sidebar-wrapper -->
      
      <!-- PAGE CONTENT START -->
      <section id="home">
			<div class="container">
				<div class="col-lg-12 row">
					<div  class="col-md-4 home-item">
						<div>
							<h3 class="home-caption">Packages</h3>
						</div>
						<div id="div_home_packages">
						</div>
					</div>
					<div class="col-md-4 home-item">
						<div>
							<h3 class="home-caption">Parameters</h3>
						</div>
						<div id="home_parameters" class ="table-responsive">
							<table id="table_sort_params" class="table table-striped">
								<tr class="tr-border">
									<td><label for="startTime">Start Time:</label></td>
									<td>
										<form>
											<input type="time" name="usr_time" value = "04:00:00">
										</form>
									</td>
								</tr>
								<tr class="tr-border">
									<td><label for="flowRate">Flow Rate:</label></td>
									<td>
										<form oninput="x.value=parseInt(a.value)">
											0
											<input onchange="checkStatus()" type="range" id="a" value="4257" min="0" max="10000">
											10k = 
											<output name="x" id="x" for="a">4257</output>
										</form>
									</td>
								</tr>
								<tr class="tr-border">
									<td><label>Packages:</label></td>
									<td>
										<form oninput="y.value=parseInt(b.value)">
										0
										<input onchange="checkStatus()" type="range" id="b" value="15248" min="0" max="20000">
										20k = 
										<output name="y" id="y" for="b">15248</output>
										</form>
									</td>
								</tr>
								<tr class="tr-border">
									<td><label>Employees:</label></td>
									<td>
										<form oninput="z.value=parseInt(c.value)">
										0
										<input onchange="checkStatus()" type="range" id="c" value="27" min="0" max="100">
										100 = 
										<output name="z" id="z" for="c">27</output>
										</form>
									</td>
								</tr>
							</table>
						</div>
						<div class="row">
							<div class="col-md-12 home-item">
								<div>
									<h3 class="home-caption">Visuals</h3>
								</div>
								<a class="home-link">
									<div class="home-hover">
										<div class="home-hover-content">
										</div>
									</div>
									<img src="img/home/Visuals.png" class="home-img-responsive" alt="">
								</a>						
							</div>
						</div>
					</div>
					<div class="col-md-4 home-item">
						<div>
							<h3 class="home-caption">Expectations</h3>
						</div>
						<div id="home_expecs" class ="table-responsive">
							<table id="table_home_expecs" class="table table-striped">
								<tr class="tr-border">
									<td><label>Completion Time:</label></td>
									<td><label>6:48am</label></td>
								</tr>
								<tr class="tr-border">
									<td><label>Sort Duration:</label></td>
									<td><label>2 hours, 48 minutes</label></td>
								</tr>
								<tr class="tr-border">
									<td><label>Deviation (+/-):</label></td>
									<td><label>8 Minutes</label></td>
								</tr>
								<tr class="tr-border">
									<td><label>Result Window:</label></td>
									<td><label>6:40am - 6:56am</label></td>
								</tr>
								<tr class="tr-border">
									<td><label>Predicted Sort Status:</label></td>
									<td id="estStatus"></td>
								</tr>
							</table>
						</div>
						<div class="row">
							<div class="col-md-12 home-item">
								<div>
									<h3 class="home-caption">Suggestions</h3>
								</div>
								<div id="home_suggests" class ="table-responsive">
									<table id="table_home_suggests" class="table table-striped">
										<tr class="tr-border">
											<td class = "home-td-left"><label>Adding two additional employees to the shift would
											decrease the overall sort time by 14 minutes.</label></td>
											
										</tr>
										<tr class="tr-border">
											<td class = "home-td-left"><label>Beginning the sort at 4:24am instead of at 4:48am
											would provide you with an estimated 15 minutes of contingency 
											time for completing the sort on schedule.</label></td>
										</tr>
										<tr class="tr-border">
											<td class = "home-td-left"><label>Based on the current parameters, this sort 
											should be completed on time.</label></td>
										</tr>
									</table>
								</div>					
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
      <!-- PAGE CONTENT END  -->
    </div> <!-- /wrapper -->
  </div> <!-- /container -->
  
</body>

     
      <!-- Reference: https://v4-alpha.getbootstrap.com/components/modal/ -->
      <div id="settings_modal" class="modal fade">
      <div class="modal-dialog" role="document">
      <div class="modal-content">
        <!-- HEADER -->
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span style="visibility:visible;">&times;</span>
          </button>
        </div>
        <!-- BODY -->
        <div class="modal-body settings">
			<h1 class="text-center">Settings</h1>
			<label>
				<span style="visibility:visible;">User Name:</span>
				<input id="settings_username" type="text" name="name" placeholder="User Name" value="ManagerJohn"/>
			</label>
			<label>
				<span style="visibility:visible;">Email:</span>
				<input id="settings_email" type="email" name="email" value="managerJohn@fedex.com" />
			</label>
			<label>
				<span style="visibility:visible;">Password:</span>
				<input id="settings_password" type="password" name="password" value="password" />
			</label>
			
			 <label>
				<span style="visibility:visible;">Time Zone:</span>
				<select name="selection">
					<option value="EST">Eastern Standard Time</option>
					<option value="CST">Central Standard Time</option>
					<option value="MST">Mountain Standard Time</option>
					<option value="PST">Pacific Standard Time</option>
				</select>
			</label>      
        </div>
        <!-- FOOTER -->
        <div class="modal-footer">
          <button type="button" class="btn btn-purple" data-dismiss="modal" onclick="updateUser();">Save</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
      </div>
      </div>

<!-- SCRIPTS -->
<script src="js/jquery.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="js/bootstrap.min.js"></script>
<script src="js/queryString.js"></script>
<script src="js/home-packages.js"></script>


  
<!-- MAIN SCRIPT -->
<script>
$("#menu-toggle").click(function(e) {
    e.preventDefault();
    $("#wrapper").toggleClass("toggled");
});

// Create a new truck/plane with a volume and arrival time
// and insert it into the Package Breakdown table
// Reference: https://developer.mozilla.org/en-US/docs/Web/API/HTMLTableElement/insertRow
function makeIncomingPackage(){
  try{    
    // Vehicle
	var carrier_num_min = 100;
    var carrier_num_max = 1900;
	var carrier_num_rand = Math.floor( Math.random()*carrier_num_max + carrier_num_min );
    var vehicle_array = ["<p class=\"fa fa-truck\" aria-hidden=\"true\"></p>", 
                         "<p class=\"fa fa-plane\" aria-hidden=\"true\"></p>"];
    var vehicle_index = Math.floor( Math.random()*2 );  // [0, 1]        
    var carrier_type = vehicle_array[vehicle_index];

    // Volume
    var volume_truck_min = 100;
    var volume_truck_max = 1900;
    var volume_plane_min = 100;
    var volume_plane_max = 20000;
    var text_volume; 
    if( vehicle_index == 0 ){
      var volume_random = Math.floor( Math.random()*volume_truck_max + volume_truck_min );
      text_volume = volume_random;
    }else{
      var volume_random = Math.floor( Math.random()*volume_plane_max + volume_plane_min );
      text_volume = volume_random;
    }
    
    // Time
    var hour_random = Math.floor( Math.random()*06 + 1 ); // [1, 7]
    var minute_random = Math.floor( Math.random()*59 + 1 ); // [1, 59]
    
 
    return new Array(carrier_type,
					carrier_num_rand,
                    text_volume, 
                    [hour_random, minute_random, 0]);
  }
  catch( e ){
    alert("makIncomingPackage:\n" + e);
  }
}

function drawChart(){
    // Reference: https://developers.google.com/chart/interactive/docs/examples
    data = new google.visualization.DataTable();
    data.addColumn('string', 'Car. Type');
	data.addColumn('number', 'Car. No.');
    data.addColumn('number', 'Volume');
    data.addColumn('timeofday', 'Arrival Time');
    
    data.addRows(30);
    for(row = 0; row < 30; row++){
      var p = makeIncomingPackage();
      data.setCell(row, 0, p[0]);
      data.setCell(row, 1, p[1]);
      data.setCell(row, 2, p[2]);
	  data.setCell(row, 3, p[3]);
    }
    
    table_incoming = new google.visualization.Table( document.getElementById("div_home_packages") );
    table_incoming.draw(data, {width: '100%', height: '525px', allowHtml: true});
    google.visualization.events.addListener(table_incoming, 'select', tableSelectHandler);
}

// Reference: https://developers.google.com/chart/interactive/docs/events
function tableSelectHandler(){  
  try{
    var sel = table_incoming.getSelection();
    for(var i = 0; i < sel.length; i++){
      var item = sel[i];
      var row_int = item.row;
      if( !row_int ) row_int = 0;
      
      //alert( data.getFormattedValue(row_int, 0) );
      //alert( data.getFormattedValue(row_int, 1) );
      //alert( data.getFormattedValue(row_int, 2) );
      //alert( data.getFormattedValue(row_int, 3) );
      //alert( data.getFormattedValue(row_int, 4) );
    }
  }catch( err ){
    alert( err );
  }
}

// DOCUMENT LOADED
window.onload = function(){
  try{
    google.charts.load('current', {'packages' : ['corechart', 'table']});
    google.charts.setOnLoadCallback( drawChart );
    
    // Update the margin because css doesn't work for the dynamically created table.
    document.getElementById("div_home_packages").setAttribute("style", "margin-bottom: 2.0em;");
  }
  catch( e ){
    alert(e);
  }
}

//code to determine success estimate or failure estimate
function checkStatus (evt)
{
	var a = document.getElementById("a").value;
	var b = document.getElementById("b").value;
	var c = document.getElementById("c").value;
	
	if (a < 3000) {
		document.getElementById("estStatus").innerHTML = "<label class=\"fa3 fa-times\" aria-hidden=\"true\"></label><label class=\"success\">&nbsp;Unsuccessful</label>";
	} else if (b > 16000) {
		document.getElementById("estStatus").innerHTML = "<label class=\"fa3 fa-times\" aria-hidden=\"true\"></label><label class=\"success\">&nbsp;Unsuccessful</label>";
	} else if (c < 25) {
		document.getElementById("estStatus").innerHTML = "<label class=\"fa3 fa-times\" aria-hidden=\"true\"></label><label class=\"success\">&nbsp;Unsuccessful</label>";
	} else { 
		document.getElementById("estStatus").innerHTML = "<label class=\"fa2 fa-check\" aria-hidden=\"true\"></label><label class=\"success\">&nbsp;Successful</label>";
	}
}
checkStatus();



</script>
<script> //insert current date into header

	var today = new Date();
	var date = (today.getMonth()+1)+'/'+today.getDate()+'/'+ today.getFullYear();
	
	var curDate = document.getElementById("curDate");
	curDate.innerHTML = "<p class='header-info'>Date: " + date + "</p>";
</script>
<script>
	function updateUser() {
		var user = document.getElementById("settings_username").value;
		var queries = "?username="+user+"&alertNum=6";
		href="index.html";
		location.href=this.href+queries;
	}
</script>
</html>